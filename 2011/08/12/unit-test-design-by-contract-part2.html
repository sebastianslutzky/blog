<!doctype html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en"> <![endif]-->
<html class="no-js" lang="en" data-useragent="Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit testing with Design By Contract (part 2)</title>
    <meta name="description" content="The Jekyll AsciiDoc Quickstart project is a leg-up in starting your own website hosted on GitHub with content based in AsciiDoc.">
    <meta name="author" content="Your name goes here">
    <meta name="copyright" content="Maybe consider a Creative Commons license">
    <link rel="stylesheet" href="../../../css/foundation.css">
    <link rel="stylesheet" href="../../../css/font-awesome.css">
    <link rel="stylesheet" href="../../../css/coderay.css">
    <link rel="stylesheet" href="../../../css/asciidoctor.css">
    <script src="../../../js/vendor/modernizr.js"></script>
    <script src="../../../js/toc.js"></script>
</head>
<body>


<!-- Nav Bar -->

<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <!-- Title Area -->
        <li class="name">
            <h1>
                <a href="../../../">Jekyll AsciiDoc  Quickstart</a>
            </h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->

<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns" role="content">

        <h1>Unit testing with Design By Contract (part 2)</h1>
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="/images/dbc.png" alt="dbc" width="100%">
</div>
</div>
<div class="paragraph">
<p><em>This article is the second of three on <a href="http://sebastianslutzky.com/2011/08/08/unit-testing-with-design-by-contract/">Unit Testing and Design By Contract</a></em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing_post_conditions_and_class_invariants">Testing Post Conditions and Class Invariants</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our User Story contains two pre conditions, so we should write a test for each of them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csharp">[Test, ExpectedException( typeof(ArgumentNullException))]
public void Add_PreCond_ItemIsRequired()
{
    new Stack(maximumNumberOfItemsAllowed: 1)
        .Add(null);
}

[Test,
ExpectedException(typeof(InvalidOperationException),
    ExpectedMessage=&quot;Cannot add items when the stack is full.&quot;)]
public void Add_PreCond_StackCantBeFull()
{
    new Stack(maximumNumberOfItemsAllowed: 0)
        .Add(new object());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These unit tests ensure that if any of the two pre conditions are not satisfied, the Supplier will not execute the method. To do so, it throws an error to the Client.</p>
</div>
<div class="paragraph">
<p>When we unit tests this behaviour, we assert that the Unit Tests will result in an exception being thrown, and we can additionally specify the type of the exception. These types of tests are also known as Unhappy Tests.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="happy_case_the_n_1_pre_condition">Happy Case: The N + 1 Pre Condition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>How do you test that all pre conditions are met? Well, you could argue that is not needed, when testing post conditions we can assume that the method is executed, what means that we passed all pre condition checks.</p>
</div>
<div class="paragraph">
<p>Let’s suppose a new pre condition is added to the class, and that the developer forgets to write the Unit Test for it. Yes, all post-condition tests should now fail: there is a new pre condition in town. But this may not happen, what if the new pre condition was coincidentally met by all tests? For example, a new requirement that only allows us to add non empty strings to the stack may not be detected by any existing test if they already use non empty strings only.</p>
</div>
<div class="paragraph">
<p>There is another problem, related to error localization. In his brilliant book “Working Effectively with Legacy Code” Michael Feathers emphasizes that one of the benefits of good tests is that it helps us to easily localize problems. With a happy case, we do not want to test the outcome of a method. We want to check that if all pre requisites are satisfied, the method throws no error. This is the opposite scenario
of an unhappy case, that is, a happy case for pre conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csharp">[Test]
public void Add_PreCond_HappyCase()
{
    new Stack(maximumNumberOfItemsAllowed: 1)
        .Add(new object());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that we are not doing any checking on this test. We simply want to pass all the validations for pre conditions. We are also not interested in testing the state of the stack after adding the item. In other words, we are not testing pre conditions either. We will do that in the nexdt part</p>
</div>
</div>
</div>
<h1 id="coming_next" class="sect0">Coming Next:</h1>
<div class="paragraph">
<p><a href="https://sebastianslutzky.wordpress.com/2011/08/13/testing-post-conditions-and-class-invariants/">Testing Post Conditions and Class Invariants</a></p>
</div>

    </div>

    <!-- End Main Content -->

    <!-- Sidebar -->

    <aside class="large-3 columns">

        <h4>Posts</h4>
        <ul id="posts" class="posts nav">
            
            <li><a href="/./2015/11/24/take-control-of-your-api-aspects.html">Take control of your Web API aspects</a></li>
            
            <li><a href="/./2011/10/29/naked-objects-is-opensource.html">Naked Objects is now open sourced.</a></li>
            
            <li><a href="/./2011/08/22/apply-operation-in-collection-with-linq.html">Apply an operation to a collection with LinQ</a></li>
            
            <li><a href="/./2011/08/13/unit-test-design-by-contract-part3.html">Unit Test &amp; Design By Contract (III)</a></li>
            
            <li><a href="/./2011/08/12/unit-test-design-by-contract-part2.html">Unit Test &amp; Design By Contract (II)</a></li>
            
            <li><a href="/./2011/08/08/unit-test-design-by-contract-part2.html">Unit Test &amp; Design By Contract (I)</a></li>
            
            <li><a href="/./2011/08/08/unit-test-design-by-contract-part1.html">Unit Test &amp; Design By Contract (I)</a></li>
            
        </ul>

        <div class="panel">
            <h5>Featured</h5>

            <p>Pork drumstick turkey fugiat. Tri-tip elit turducken pork chop in. Swine short ribs meatball irure bacon
                nulla pork belly cupidatat meatloaf cow.</p>
        </div>

    </aside>

    <!-- End Sidebar -->
</div>

<!-- End Main Content and Sidebar -->


<!-- Footer -->

<footer class="row">
    <div class="large-12 columns">
        <hr>
        <div class="row">
            <div class="large-12 columns">
                <p>Footer</p>
            </div>
        </div>
    </div>
</footer>

<script src="../../../js/vendor/jquery.js"></script>
<script src="../../../js/foundation.min.js"></script>
<script>
$(document).foundation();
var doc = document.documentElement;
doc.setAttribute('data-useragent', navigator.userAgent);
</script>
</body>
</html>
